@page "/"
@page "/home"
@inject Microsoft.Extensions.Localization.IStringLocalizer<ListProducts> _localizer
@using LaptopStore.Application.Features.Products.Queries.GetAllPaged;

<style>
    .search-container {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }

    .product-grid .mud-item {
        display: flex;
        flex-direction: column;
    }
</style>

<!-- Tìm kiếm chung cho cả hai bảng -->
<div class="search-container">
    <MudTextField T="string" @bind-Value="_searchString" Placeholder="@_localizer["Search..."]"
                  Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search"
                  IconSize="Size.Medium" Class="mt-0" />
</div>

<!-- Featured Products Section -->
<HeroTitle Title="@_localizer["Featured Products"]" Description="@_localizer["Featured Products."]" />
@if (!_loaded)
{
    <MudProgressCircular Color="Color.Primary" Indeterminate="false" />
}
else if (_featuredProducts.Any())
{
    <MudGrid GutterSpacing="3" Class="product-grid">
        @foreach (var context in _featuredProducts)
        {
            <MudItem xs="12" sm="6" md="4" lg="3">
                <MudCard Style="padding: 16px; margin-bottom: 16px; height: 100%;">
                    <MudCardContent>
                        <MudAvatar Image="@(context.ImageDataURL)" Square="true" Style="height: auto; width: 100%; max-height: 150px;" />
                        <MudText Typo="Typo.h6" Class="mt-2">@context.Name</MudText>
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">
                            @context.Price.ToString("N0") đ
                        </MudText>
                        <MudText Typo="Typo.body2" Color="Color.Secondary">@context.Brand</MudText>
                        <MudText Typo="Typo.body2">@context.Description</MudText>
                        <MudText Typo="Typo.body2">Đánh giá: @context.Rate</MudText>
                    </MudCardContent>
                    <MudCardActions>
                        <MudButton Variant="Variant.Filled" Color="Color.Primary">Xem chi tiết</MudButton>
                        <MudButton Variant="Variant.Text" Color="Color.Secondary">So sánh</MudButton>
                    </MudCardActions>
                </MudCard>
            </MudItem>
        }
    </MudGrid>
}

<!-- High Rate Products Section -->
<HeroTitle Title="@_localizer["High Rate Products"]" Description="@_localizer["Products with rate >= 4"]" />
@if (!_loaded)
{
    <MudProgressCircular Color="Color.Primary" Indeterminate="false" />
}
else if (_highRatedProducts.Any())
{
    <MudGrid GutterSpacing="3" Class="product-grid">
        @foreach (var context in _highRatedProducts)
        {
            <MudItem xs="12" sm="6" md="4" lg="3">
                <MudCard Style="padding: 16px; margin-bottom: 16px; height: 100%;">
                    <MudCardContent>
                        <MudAvatar Image="@(context.ImageDataURL)" Square="true" Style="height: auto; width: 100%; max-height: 150px;" />
                        <MudText Typo="Typo.h6" Class="mt-2">@context.Name</MudText>
                        <MudText Typo="Typo.subtitle2" Color="Color.Primary">
                            @context.Price.ToString("N0") đ
                        </MudText>
                        <MudText Typo="Typo.body2" Color="Color.Secondary">@context.Brand</MudText>
                        <MudText Typo="Typo.body2">@context.Description</MudText>
                        <MudText Typo="Typo.body2">Đánh giá: @context.Rate</MudText>
                    </MudCardContent>
                    <MudCardActions>
                        <MudButton Variant="Variant.Filled" Color="Color.Primary">Xem chi tiết</MudButton>
                        <MudButton Variant="Variant.Text" Color="Color.Secondary">So sánh</MudButton>
                    </MudCardActions>
                </MudCard>
            </MudItem>
        }
    </MudGrid>
}
